package fr.xmalware.badblocktab.listeners;

import org.bukkit.Bukkit;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;

import fr.xmalware.badblocktab.BadBlockTab;
import fr.xmalware.badblocktab.objects.TabPlayer;
import ru.tehkode.permissions.events.PermissionEntityEvent;

public class PermissionEntityListener implements Listener {
	
	@EventHandler
	public void onPermissionEntity(PermissionEntityEvent event) {
		Player player = Bukkit.getPlayer(event.getEntity().getName());
		long time = System.currentTimeMillis();
		//Bukkit.broadcastMessage("§e[STAPE 2] Testing for " + player.getName() + "...");
		if (player == null || !player.isOnline()) return;
		TabPlayer tabPlayer = TabPlayer.getPlayer(player);
		tabPlayer.group = BadBlockTab.getInstance().permissionsExManager.getGroup(player);
		tabPlayer.suffix = BadBlockTab.getInstance().permissionsExManager.getSuffix(player);
		tabPlayer.prefix = BadBlockTab.getInstance().permissionsExManager.getPrefix(player);
		//Bukkit.broadcastMessage("§e[STAPE 2] (1/2) Testing for " + player.getName() + "...");
		tabPlayer.update();
		//Bukkit.broadcastMessage("§e[STAPE 2] (2/2) Tested for " + player.getName() + "...");
	}
	
}
